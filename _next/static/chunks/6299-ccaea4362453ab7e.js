"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6299],{39763:function(e,r,t){t.d(r,{Z:function(){return i}});var a=t(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,r)=>{let t=(0,a.forwardRef)((t,i)=>{let{color:o="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:h,...f}=t;return(0,a.createElement)("svg",{ref:i,...n,width:l,height:l,stroke:o,strokeWidth:u?24*Number(c)/Number(l):c,className:["lucide","lucide-".concat(s(e)),d].join(" "),...f},[...r.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(h)?h:[h]])});return t.displayName="".concat(e),t}},32660:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},46221:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},31047:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},2207:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]])},98728:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},88906:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},95805:function(e,r,t){t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},27648:function(e,r,t){t.d(r,{default:function(){return n.a}});var a=t(72972),n=t.n(a)},99376:function(e,r,t){var a=t(35475);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},20438:function(e,r,t){t.d(r,{Z:function(){return f}});var a=t(57437),n=t(27648),s=t(84603),i=t(99376),o=t(2265),l=t(32660),c=t(88906),u=t(95805),d=t(46221),h=t(98728);function f(e){let{children:r,title:t,description:f}=e,{user:m,userProfile:g,loading:y}=(0,s.a)(),p=(0,i.useRouter)();return((0,o.useEffect)(()=>{y||m&&g&&"admin"===g.role||p.push("/")},[m,g,y,p]),y)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):m&&g&&"admin"===g.role?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(n.default,{href:"/",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Back to Site"})]}),(0,a.jsx)("div",{className:"border-l border-gray-300 h-6"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:"Admin Panel"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)(n.default,{href:"/admin",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Users"})]}),(0,a.jsxs)(n.default,{href:"/admin/analytics",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Analytics"})]}),(0,a.jsxs)(n.default,{href:"/admin/settings",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Settings"})]}),!1]})]})})}),(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t}),f&&(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:f})]})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r})]}):null}},84603:function(e,r,t){t.d(r,{AuthProvider:function(){return u},a:function(){return d}});var a=t(57437),n=t(2265),s=t(43301),i=t(46410),o=t(99764),l=t(40257);let c=(0,n.createContext)(void 0);function u(e){let{children:r}=e,[t,u]=(0,n.useState)(null),[d,h]=(0,n.useState)(null),[f,m]=(0,n.useState)(!0),g=async e=>{try{var r,t;console.log("\uD83D\uDD0D Loading user profile for UID:",e.uid);let a=await e.getIdToken();try{let r=await o.G.getUserProfile(e.uid,a);if(r){console.log("\uD83D\uDCCB Profile data loaded from server:",r),h(r);return}}catch(e){console.warn("⚠️ Server unavailable, using fallback profile:",e)}console.log("\uD83D\uDD04 Creating fallback local profile...");let n=(null===(r=e.email)||void 0===r?void 0:r.includes("admin"))||(null===(t=e.email)||void 0===t?void 0:t.includes("test")),s={uid:e.uid,email:e.email,displayName:e.displayName||e.email.split("@")[0],role:n?"admin":"user",createdAt:new Date,updatedAt:new Date};h(s),console.log("✅ Fallback profile created:",s)}catch(e){console.error("❌ Error loading user profile:",e)}};(0,n.useEffect)(()=>{if(console.log("\uD83D\uDD25 Firebase config:",{configured:i.Wn,apiKey:l.env.NEXT_PUBLIC_FIREBASE_API_KEY?"loaded":"missing",authDomain:l.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN?"loaded":"missing",projectId:l.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID?"loaded":"missing"}),!i.Wn||!i.I8){console.log("⚠️ Firebase not configured, auth will be disabled"),m(!1);return}let e=(0,s.Aj)(i.I8,async e=>{console.log("\uD83D\uDD04 Auth state changed:",e?"User logged in: ".concat(e.email):"User logged out"),u(e),e?(console.log("\uD83D\uDD04 Loading profile for authenticated user..."),await g(e)):(console.log("\uD83D\uDD04 Clearing user profile..."),h(null)),m(!1)});return()=>e()},[]);let y=async(e,r)=>{if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{console.log("\uD83D\uDD10 useAuth: Starting sign in process for:",e);let t=await (0,s.e5)(i.I8,e,r);console.log("✅ useAuth: Firebase sign in successful:",t.user.uid)}catch(e){throw console.error("❌ useAuth: Sign in failed:",e),Error(e.message)}},p=async(e,r,t)=>{if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{let{user:a}=await (0,s.Xb)(i.I8,e,r);await (0,s.ck)(a,{displayName:t});let n=await a.getIdToken();await o.G.createUserProfile(a.uid,{email:e,displayName:t,role:"user"},n)}catch(e){throw Error(e.message)}},x=async()=>{if(!i.Wn||!i.I8){console.log("⚠️ Firebase not configured, clearing local state"),u(null),h(null);return}try{await (0,s.w7)(i.I8)}catch(e){throw Error(e.message)}},w=async e=>{if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{await (0,s.LS)(i.I8,e)}catch(e){throw Error(e.message)}},v=async e=>{if(!t)throw Error("No user authenticated");if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{let r=await t.getIdToken();if(!await o.G.updateUserProfile(t.uid,e,r))throw Error("Failed to update profile on server");e.displayName&&await (0,s.ck)(t,{displayName:e.displayName}),h(r=>r?{...r,...e,updatedAt:new Date}:null)}catch(e){throw Error(e.message)}};return(0,a.jsx)(c.Provider,{value:{user:t,userProfile:d,loading:f,signIn:y,signUp:p,logout:x,resetPassword:w,updateUserProfile:v,hasPermission:e=>!!d&&(({admin:["create","read","update","delete","manage_users"],editor:["create","read","update"],contributor:["create","read"],reader:["read"]})[d.role]||[]).includes(e)},children:r})}function d(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},46410:function(e,r,t){t.d(r,{I8:function(){return u},Wn:function(){return l},db:function(){return d}});var a=t(738),n=t(43301),s=t(5978),i=t(40257);let o={apiKey:i.env.NEXT_PUBLIC_FIREBASE_API_KEY||"dummy-api-key",authDomain:i.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"dummy-project.firebaseapp.com",projectId:i.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"dummy-project"},l=!!(i.env.NEXT_PUBLIC_FIREBASE_API_KEY&&i.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN&&i.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID),c=null,u=null,d=null;try{c=0===(0,a.C6)().length?(0,a.ZF)(o):(0,a.C6)()[0],u=(0,n.v0)(c),d=(0,s.ad)(c),console.log("\uD83D\uDD25 Firebase initialized:",{configured:l,environment:"production"})}catch(e){console.warn("⚠️ Firebase initialization failed:",e),console.log("\uD83D\uDD27 This is normal during build time or when Firebase env vars are missing"),u=null,d=null}},99764:function(e,r,t){t.d(r,{G:function(){return s}});var a=t(40257);class n{getServerUrl(){let e=a.env.NEXT_PUBLIC_SERVER_URL;return e?e.includes("/.netlify/functions")?e.replace("/.netlify/functions",""):e:"https://abstractalgorithms-server.netlify.app"}async makeRequest(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(this.getServerUrl(),"/.netlify/functions/").concat(e);console.log("\uD83C\uDF10 Making request to:",t),console.log("\uD83D\uDD27 Environment:","production"),console.log("\uD83D\uDD17 Server URL:",this.getServerUrl());let a=await fetch(t,{...r,headers:{"Content-Type":"application/json",...r.headers}});if(!a.ok)throw console.error("❌ Server request failed:",a.status,a.statusText),Error("Server request failed: ".concat(a.statusText));return a.json()}async getUserProfile(e,r){try{let t={};r&&(t.Authorization="Bearer ".concat(r));let a=await this.makeRequest("firebase-auth?uid=".concat(e),{method:"GET",headers:t});if(a.success&&a.user)return{...a.user,createdAt:new Date(a.user.createdAt),updatedAt:new Date(a.user.updatedAt)};return null}catch(e){return console.error("Error fetching user profile:",e),null}}async updateUserProfile(e,r,t){try{return(await this.makeRequest("firebase-auth",{method:"PUT",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({uid:e,updateData:{...r,updatedAt:new Date().toISOString()}})})).success}catch(e){return console.error("Error updating user profile:",e),!1}}async listUsers(e){try{let r=await this.makeRequest("firebase-auth?action=list_users",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(r.success&&r.users)return r.users.map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));return[]}catch(e){return console.error("Error listing users:",e),[]}}async updateUserRole(e,r,t){try{return(await this.makeRequest("firebase-auth",{method:"PUT",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({uid:e,role:r,updateData:{role:r,updatedAt:new Date().toISOString()}})})).success}catch(e){return console.error("Error updating user role:",e),!1}}async createUserProfile(e,r,t){try{return(await this.makeRequest("firebase-auth",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({uid:e,...r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})})).success}catch(e){return console.error("Error creating user profile:",e),!1}}async deleteUser(e,r){try{return(await this.makeRequest("firebase-auth?uid=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}})).success}catch(e){return console.error("Error deleting user:",e),!1}}}let s=new n}}]);