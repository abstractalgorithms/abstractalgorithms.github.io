(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{43427:function(e,s,t){Promise.resolve().then(t.bind(t,52045))},38208:function(e,s,t){"use strict";t.d(s,{CK:function(){return o.Z},CP:function(){return O.Z},Cc:function(){return E.Z},Jr:function(){return n.Z},Mh:function(){return N.Z},P$:function(){return F.Z},S9:function(){return p.Z},UW:function(){return x.Z},Vh:function(){return M.Z},Vz:function(){return I.Z},WF:function(){return Z.Z},W_:function(){return V.Z},X:function(){return U.Z},X4:function(){return w.Z},Xy:function(){return r.Z},YG:function(){return m.Z},Z8:function(){return S.Z},Zr:function(){return A.Z},_Q:function(){return d.Z},a2:function(){return a.Z},aV:function(){return y.Z},ac:function(){return h.Z},bA:function(){return g.Z},bK:function(){return k.Z},bY:function(){return P.Z},dL:function(){return u.Z},f:function(){return i.Z},kb:function(){return f.Z},ls:function(){return c.Z},oQ:function(){return L.Z},ol:function(){return T.Z},p1:function(){return l.Z},qF:function(){return b.Z},sC:function(){return R.Z},v3:function(){return D.Z},vu:function(){return j.Z},vw:function(){return C.Z},zM:function(){return v.Z}});var r=t(9334),a=t(20265),l=t(71769),i=t(31047),n=t(30401),c=t(97418),d=t(10407),o=t(78867),x=t(92735),m=t(2207),u=t(96362),g=t(42208),h=t(48736),b=t(41473),f=t(41217),p=t(28124),j=t(25846),w=t(29985),y=t(7586),v=t(15863),N=t(89345),S=t(82718),Z=t(21047),V=t(77877),E=t(34423),D=t(99397),L=t(82431),P=t(69076),T=t(73247),C=t(44743),A=t(98728),O=t(68919),F=t(82023),k=t(61094),I=t(58896),M=t(18930),R=t(42820),U=t(32489)},91151:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});var r=t(2265);function a(){return(0,r.useEffect)(()=>{let e;console.log("\uD83D\uDD0D Environment Debug Info:"),console.log("NODE_ENV:","production"),console.log("NEXT_PUBLIC_SERVER_URL:","https://splendid-sfogliatella-6bc915.netlify.app");let s="https://splendid-sfogliatella-6bc915.netlify.app";console.log("Resolved Server URL:",e=s?s.includes("/.netlify/functions")?s.replace("/.netlify/functions",""):s:"https://abstractalgorithms-server.netlify.app"),console.log("Final API URL would be:","".concat(e,"/.netlify/functions/save-views"))},[]),null}},55091:function(e,s,t){"use strict";t.d(s,{Z:function(){return h}});var r=t(57437),a=t(2265),l=t(5978),i=t(46410);class n{async getPostViews(e){try{let t=(0,l.JU)(i.db,this.COLLECTION_NAME,e),r=await (0,l.QT)(t);if(!r.exists())return{slug:e,views:0,lastViewed:new Date().toISOString(),dailyViews:{}};{var s;let t=r.data();return{slug:e,views:t.count||0,lastViewed:(null===(s=t.lastViewed)||void 0===s?void 0:s.toDate().toISOString())||new Date().toISOString(),dailyViews:t.dailyViews||{}}}}catch(e){throw console.error("Error getting post views:",e),Error("Failed to get post views")}}async getAllPostViews(){try{let e=(0,l.IO)((0,l.hJ)(i.db,this.COLLECTION_NAME),(0,l.Xo)("count","desc")),s=await (0,l.PL)(e),t=[],r=0;return s.forEach(e=>{var s;let a=e.data(),l={slug:e.id,views:a.count||0,lastViewed:(null===(s=a.lastViewed)||void 0===s?void 0:s.toDate().toISOString())||new Date().toISOString(),dailyViews:a.dailyViews||{}};t.push(l),r+=l.views}),{posts:t,totalViews:r}}catch(e){throw console.error("Error getting all post views:",e),Error("Failed to get all post views")}}async incrementPostViews(e){try{let s=(0,l.JU)(i.db,this.COLLECTION_NAME,e),t=l.EK.now(),r=new Date().toISOString().split("T")[0],a=await (0,l.QT)(s);if(a.exists()){let i=a.data(),n=i.dailyViews||{};n[r]=(n[r]||0)+1;let c=new Date;c.setDate(c.getDate()-30);let d=c.toISOString().split("T")[0];return Object.keys(n).forEach(e=>{e<d&&delete n[e]}),await (0,l.r7)(s,{count:(0,l.nP)(1),lastViewed:t,dailyViews:n,updatedAt:t}),{slug:e,views:(i.count||0)+1,lastViewed:t.toDate().toISOString(),dailyViews:n}}{let a={[r]:1};return await (0,l.pl)(s,{count:1,lastViewed:t,dailyViews:a,createdAt:t,updatedAt:t}),{slug:e,views:1,lastViewed:t.toDate().toISOString(),dailyViews:a}}}catch(e){throw console.error("Error incrementing post views:",e),Error("Failed to increment post views")}}async getAnalytics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;try{let{posts:s,totalViews:t}=await this.getAllPostViews(),r=new Date().toISOString().split("T")[0],a=0,l={};s.forEach(e=>{e.dailyViews&&(a+=e.dailyViews[r]||0,Object.entries(e.dailyViews).forEach(e=>{let[s,t]=e;l[s]=(l[s]||0)+t}))});let i=[];for(let s=e-1;s>=0;s--){let e=new Date;e.setDate(e.getDate()-s);let t=e.toISOString().split("T")[0];i.push({date:t,views:l[t]||0})}let n=s.slice(0,10);return{totalViews:t,viewsToday:a,topPosts:n,dailyTrend:i}}catch(e){throw console.error("Error getting analytics:",e),Error("Failed to get analytics")}}async migrateFromFileData(e){try{let s=[];for(let[t,r]of Object.entries(e)){let e=(0,l.JU)(i.db,this.COLLECTION_NAME,t),a={count:r.count||0,lastViewed:r.lastViewed?l.EK.fromDate(new Date(r.lastViewed)):l.EK.now(),dailyViews:r.dailyViews||{},createdAt:l.EK.now(),updatedAt:l.EK.now()};s.push((0,l.pl)(e,a))}await Promise.all(s),console.log("Successfully migrated ".concat(s.length," posts to Firestore"))}catch(e){throw console.error("Error migrating data to Firestore:",e),Error("Failed to migrate data to Firestore")}}constructor(){this.COLLECTION_NAME="post-views"}}let c=new n;var d=t(31047),o=t(42208),x=t(48736),m=t(33245),u=t(82431),g=t(70525);function h(e){let{localStats:s}=e,[t,l]=(0,a.useState)(null),[i,n]=(0,a.useState)(!0),[h,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{f()},[]);let f=async()=>{try{n(!0),b(null);let{posts:e,totalViews:s}=await c.getAllPostViews(),t=await c.getAnalytics(7);l({totalPosts:e.length,totalViews:s,viewsToday:t.viewsToday,topPosts:t.topPosts.slice(0,5),dailyTrend:t.dailyTrend})}catch(e){console.error("Error loading Firestore stats:",e),b(e instanceof Error?e.message:"Failed to load stats"),l({totalPosts:0,totalViews:0,viewsToday:0,topPosts:[],dailyTrend:[]})}finally{n(!1)}};if(i)return(0,r.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"})]},e))});if(h)return(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5 text-red-600 mr-2"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-900",children:"Stats Error"})]}),(0,r.jsx)("p",{className:"text-red-700 mb-4",children:h}),(0,r.jsx)("button",{onClick:f,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Retry"})]});let p=(null==t?void 0:t.dailyTrend.reduce((e,s)=>e+s.views,0))||0;return(0,r.jsxs)("div",{className:"space-y-6 mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Content Analytics"}),(0,r.jsxs)("div",{className:"ml-2 flex items-center text-sm text-gray-500",children:[(0,r.jsx)(m.Z,{className:"w-4 h-4 mr-1"}),"Local files + Firestore views"]})]}),(0,r.jsxs)("button",{onClick:f,disabled:i,className:"flex items-center px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50",children:[(0,r.jsx)(u.Z,{className:"w-4 h-4 mr-2 ".concat(i?"animate-spin":"")}),"Refresh Stats"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:s.totalPosts}),(0,r.jsx)(x.Z,{className:"w-5 h-5 text-gray-600"})]}),(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Total Posts (Local)"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:s.drafts}),(0,r.jsx)(x.Z,{className:"w-5 h-5 text-amber-600"})]}),(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Drafts"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.published}),(0,r.jsx)(x.Z,{className:"w-5 h-5 text-green-600"})]}),(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Published"})]}),(0,r.jsxs)("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:(null==t?void 0:t.totalPosts)||0}),(0,r.jsx)(o.Z,{className:"w-5 h-5 text-blue-600"})]}),(0,r.jsx)("div",{className:"text-blue-700 text-sm",children:"Posts in Firestore"})]})]}),t&&(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-emerald-50 rounded-xl p-6 border border-emerald-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-emerald-900",children:t.totalViews.toLocaleString()}),(0,r.jsx)(g.Z,{className:"w-5 h-5 text-emerald-600"})]}),(0,r.jsx)("div",{className:"text-emerald-700 text-sm",children:"Total Views"})]}),(0,r.jsxs)("div",{className:"bg-purple-50 rounded-xl p-6 border border-purple-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:t.viewsToday.toLocaleString()}),(0,r.jsx)(d.Z,{className:"w-5 h-5 text-purple-600"})]}),(0,r.jsx)("div",{className:"text-purple-700 text-sm",children:"Views Today"})]}),(0,r.jsxs)("div",{className:"bg-orange-50 rounded-xl p-6 border border-orange-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-900",children:Math.round(p/7).toLocaleString()}),(0,r.jsx)(g.Z,{className:"w-5 h-5 text-orange-600"})]}),(0,r.jsx)("div",{className:"text-orange-700 text-sm",children:"Avg Views/Day (7d)"})]})]}),t&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[(0,r.jsx)(m.Z,{className:"w-4 h-4 mr-2 text-gray-600"}),"Data Source Comparison"]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Local Files"}),(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-700 mt-1",children:s.totalPosts}),(0,r.jsx)("div",{className:"text-gray-500",children:"Posts Scanned"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Firestore"}),(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-700 mt-1",children:t.totalPosts}),(0,r.jsx)("div",{className:"text-gray-500",children:"Posts with Views"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:"Coverage"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-emerald-700 mt-1",children:[s.totalPosts>0?Math.round(t.totalPosts/s.totalPosts*100):0,"%"]}),(0,r.jsx)("div",{className:"text-gray-500",children:"Tracked Posts"})]})]})]}),t&&t.topPosts.length>0&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 mr-2 text-gray-600"}),"Top Posts by Views"]}),(0,r.jsx)("div",{className:"space-y-3",children:t.topPosts.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-xs font-medium text-gray-600 mr-3",children:s+1}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 truncate max-w-xs",children:e.slug.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Last viewed: ",new Date(e.lastViewed).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"font-semibold text-gray-900",children:e.views.toLocaleString()}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"views"})]})]},e.slug))})]}),t&&t.dailyTrend.length>0&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,r.jsx)(d.Z,{className:"w-5 h-5 mr-2 text-gray-600"}),"7-Day Views Trend"]}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-2",children:t.dailyTrend.map(e=>{let s=Math.max(...t.dailyTrend.map(e=>e.views)),a=s>0?Math.max(e.views/s*100,5):5;return(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)("div",{className:"bg-blue-200 rounded-t mx-auto",style:{height:"".concat(a,"px"),width:"24px"},title:"".concat(e.views," views on ").concat(e.date)})}),(0,r.jsx)("div",{className:"text-xs text-gray-600 font-medium",children:e.views}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:new Date(e.date).toLocaleDateString("en",{weekday:"short"})})]},e.date)})})]})]})}},2966:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});var r=t(57437),a=t(2265);function l(){let[e,s]=(0,a.useState)(""),[t,l]=(0,a.useState)("");return(0,a.useEffect)(()=>{l("https://splendid-sfogliatella-6bc915.netlify.app"),s((()=>{let e="https://splendid-sfogliatella-6bc915.netlify.app";return e?e.includes("/.netlify/functions")?e.replace("/.netlify/functions",""):e:"https://abstractalgorithms-server.netlify.app"})())},[]),(0,r.jsxs)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4",children:[(0,r.jsx)("strong",{children:"\uD83D\uDD0D Server URL Debug:"}),(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Raw ENV Variable:"})," ",t,(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Resolved Server URL:"})," ",e,(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"NODE_ENV:"})," ","production",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Final API URL would be:"})," ",e,"/.netlify/functions/save-views"]})}},71574:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var r=t(57437),a=t(2265),l=t(31047),i=t(92735),n=t(89345),c=t(82431),d=t(70525),o=t(95805),x=t(84603),m=t(62189);function u(){let{user:e}=(0,x.a)(),[s,t]=(0,a.useState)([]),[u,g]=(0,a.useState)(0),[h,b]=(0,a.useState)(!0),[f,p]=(0,a.useState)(null),[j,w]=(0,a.useState)(null),[y,v]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e&&(N(),S())},[e]);let N=async()=>{try{if(b(!0),p(null),console.log("\uD83D\uDD04 Loading subscribers from server..."),e){let s=await e.getIdToken(),r=await m.A.getSubscribers(s);if(r.success)console.log("✅ Loaded subscribers from server:",r),t(r.subscribers||[]),g(r.totalCount||0);else throw Error(r.error||"Failed to load subscribers")}}catch(e){console.error("❌ Error loading subscribers:",e),p(e instanceof Error?e.message:"Failed to load subscribers")}finally{b(!1)}},S=async()=>{v(!0);try{if(console.log("\uD83D\uDCCA Loading subscription analytics from server..."),e){let s=await e.getIdToken(),t=await m.A.getSubscriptionAnalytics(s);if(t.success)console.log("✅ Loaded analytics from server:",t),w(t.analytics);else throw Error(t.error||"Failed to load analytics")}}catch(e){console.error("❌ Error fetching analytics:",e)}finally{v(!1)}},Z=()=>{N(),S()};return h&&!s.length?(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)(c.Z,{className:"h-5 w-5 animate-spin text-gray-400"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Loading subscription data..."})]})}):f?(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-red-600 mb-4",children:[(0,r.jsx)(n.Z,{className:"h-6 w-6"}),(0,r.jsx)("span",{className:"font-medium",children:"Error Loading Subscriptions"})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:f}),(0,r.jsx)("button",{onClick:Z,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Try Again"})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Subscription Analytics"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage your email subscribers and track growth"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)("button",{onClick:Z,disabled:h||y,className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 ".concat(h||y?"animate-spin":"")}),(0,r.jsx)("span",{children:"Refresh"})]}),(0,r.jsxs)("button",{onClick:()=>{if(0===s.length)return;let e=new Blob([[["Email","Status","Subscribed At","Source"],...s.map(e=>[e.email,e.status,new Date(e.subscribedAt).toLocaleDateString(),e.source||"unknown"])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="subscribers-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(t)},disabled:0===s.length,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Export CSV"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Subscribers"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:u})]}),(0,r.jsx)("div",{className:"p-3 bg-blue-100 rounded-full",children:(0,r.jsx)(o.Z,{className:"h-6 w-6 text-blue-600"})})]})}),(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Subscribers"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:s.filter(e=>"active"===e.status).length})]}),(0,r.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,r.jsx)(n.Z,{className:"h-6 w-6 text-green-600"})})]})}),(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:(null==j?void 0:j.recentSubscriptions)||0})]}),(0,r.jsx)("div",{className:"p-3 bg-purple-100 rounded-full",children:(0,r.jsx)(l.Z,{className:"h-6 w-6 text-purple-600"})})]})}),(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Growth Rate"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:(null==j?void 0:j.growthRate)?"".concat(j.growthRate,"%"):"0%"})]}),(0,r.jsx)("div",{className:"p-3 bg-yellow-100 rounded-full",children:(0,r.jsx)(d.Z,{className:"h-6 w-6 text-yellow-600"})})]})})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Subscribers"})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subscribed"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.length>0?s.slice(0,10).map((e,s)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.source||"website"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(e.subscribedAt).toLocaleDateString()})]},s)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-6 py-8 text-center text-gray-500",children:"No subscribers found"})})})]})}),s.length>10&&(0,r.jsx)("div",{className:"px-6 py-3 bg-gray-50 text-center",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing 10 of ",s.length," subscribers"]})})]}),(null==j?void 0:j.topSources)&&j.topSources.length>0&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Subscription Sources"}),(0,r.jsx)("div",{className:"space-y-3",children:j.topSources.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 capitalize",children:e.source}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-gray-200 rounded-full h-2 w-24",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.count/Math.max(...j.topSources.map(e=>e.count))*100,"%")}})}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:e.count})]})]},s))})]})]})}},81659:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var r=t(57437),a=t(2265),l=t(22252),i=t(31047),n=t(91723),c=t(50091),d=t(42208),o=t(70525),x=t(84603),m=t(31444);function u(){let{user:e}=(0,x.a)(),[s,t]=(0,a.useState)([]),[u,g]=(0,a.useState)(0),[h,b]=(0,a.useState)(!0),[f,p]=(0,a.useState)(null),[j,w]=(0,a.useState)(null),[y,v]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e&&N(),S()},[e]);let N=async()=>{try{if(b(!0),p(null),console.log("\uD83D\uDD04 Loading views data from server..."),e){let s=await e.getIdToken(),r=await m.H.getAllViews(s);if(r.success)console.log("✅ Loaded views data from server:",r),t(r.posts||[]),g(r.totalViews||0);else throw Error(r.error||"Failed to load views data")}}catch(e){console.error("❌ Error loading views data:",e),p(e instanceof Error?e.message:"Failed to load views data")}finally{b(!1)}},S=async()=>{try{w({fileBasedDataExists:!0,fileBasedPostsCount:0,firestorePostsCount:0,migrationNeeded:!0})}catch(e){console.error("Error checking migration status:",e)}},Z=async()=>{try{v(!0);let e=await m.H.migrateViews({});e.success?(alert("Migration completed! ".concat(e.message||"Views data migrated successfully.")),await S(),window.location.reload()):alert("Migration failed: ".concat(e.error))}catch(e){console.error("Migration error:",e),alert("Migration failed. Check console for details.")}finally{v(!1)}};if(h)return(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-4 w-48"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsx)("div",{className:"h-20 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-20 bg-gray-200 rounded"})]}),(0,r.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"h-12 bg-gray-200 rounded"},e))})]})});if(f)return(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:(0,r.jsxs)("div",{className:"text-center text-gray-500",children:[(0,r.jsx)(d.Z,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),(0,r.jsx)("p",{children:"Unable to load analytics"}),(0,r.jsx)("p",{className:"text-sm text-red-500 mt-2",children:f})]})});let V=[...s].sort((e,s)=>s.views-e.views).slice(0,10),E=s.length>0?Math.round(u/s.length):0,D=s.filter(e=>e.views>0).length;return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[(null==j?void 0:j.migrationNeeded)&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(l.Z,{className:"w-5 h-5 text-yellow-600 mt-0.5 mr-3"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Migration Available"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["Found ",j.fileBasedPostsCount," posts with views data in file storage. Migrate to Firestore for better performance and reliability."]}),(0,r.jsx)("button",{onClick:Z,disabled:y,className:"mt-3 px-4 py-2 bg-yellow-600 text-white text-sm rounded-md hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Migrating...":"Migrate to Firestore"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,r.jsx)(o.Z,{className:"w-5 h-5 mr-2 text-blue-600"}),"Views Analytics"]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),j?"Firestore (".concat(j.firestorePostsCount," posts)"):"Real-time data"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,r.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Views"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:u.toLocaleString()})]}),(0,r.jsx)(d.Z,{className:"w-8 h-8 text-blue-500"})]})}),(0,r.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Posts with Views"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-900",children:D})]}),(0,r.jsx)(o.Z,{className:"w-8 h-8 text-green-500"})]})}),(0,r.jsx)("div",{className:"bg-purple-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Average Views"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:E})]}),(0,r.jsx)(i.Z,{className:"w-8 h-8 text-purple-500"})]})}),(0,r.jsx)("div",{className:"bg-orange-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-orange-600",children:"Total Posts"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-orange-900",children:s.length})]}),(0,r.jsx)(n.Z,{className:"w-8 h-8 text-orange-500"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Posts"}),0===V.length?(0,r.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,r.jsx)(d.Z,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"No views recorded yet"}),(0,r.jsx)("p",{className:"text-sm",children:"Views will appear here once visitors start reading your posts."})]}):(0,r.jsx)("div",{className:"space-y-3",children:V.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"\n                    flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold\n                    ".concat(0===s?"bg-yellow-100 text-yellow-800":1===s?"bg-gray-200 text-gray-700":2===s?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800","\n                  "),children:s+1}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.postId.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}),(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.postId}),e.lastViewed&&(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["Last viewed: ",new Date(e.lastViewed).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-shrink-0",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-lg font-bold text-gray-900",children:e.views.toLocaleString()}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"views"})]}),(0,r.jsx)(d.Z,{className:"w-4 h-4 text-gray-400"})]})]},e.postId))})]}),s.length>0&&(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"View Distribution"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(e=>0===e.views).length}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"No Views"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(e=>e.views>0&&e.views<100).length}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"1-99 Views"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(e=>e.views>=100).length}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"100+ Views"})]})]})]})]})}},30215:function(e,s,t){"use strict";function r(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function a(e){var s,t,r,a,l;let i=[];return(null===(s=e.title)||void 0===s?void 0:s.trim())||i.push("Title is required"),(null===(t=e.content)||void 0===t?void 0:t.trim())||i.push("Content is required"),(null===(r=e.excerpt)||void 0===r?void 0:r.trim())||i.push("Excerpt is required"),(null===(a=e.author)||void 0===a?void 0:a.trim())||i.push("Author is required"),e.date||i.push("Date is required"),e.series&&((null===(l=e.series.name)||void 0===l?void 0:l.trim())||i.push("Series name is required when adding to series"),(!e.series.order||e.series.order<1)&&i.push("Series order must be a positive number"),(!e.series.total||e.series.total<1)&&i.push("Series total must be a positive number"),e.series.order>e.series.total&&i.push("Series order cannot be greater than total parts")),{isValid:0===i.length,errors:i}}t.d(s,{CT:function(){return a},GD:function(){return r}})}}]);