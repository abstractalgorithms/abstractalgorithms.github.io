(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4152],{66165:function(e,t,r){Promise.resolve().then(r.bind(r,57332))},39763:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{color:i="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:u="",children:h,...p}=r;return(0,s.createElement)("svg",{ref:o,...a,width:l,height:l,stroke:i,strokeWidth:d?24*Number(c)/Number(l):c,className:["lucide","lucide-".concat(n(e)),u].join(" "),...p},[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},31047:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},91723:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},42208:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},94630:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},18930:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},92369:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},57332:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var s=r(57437),a=r(84603),n=r(2265),o=r(40257);class i{getServerUrl(){let e=o.env.NEXT_PUBLIC_SERVER_URL;if(console.log("\uD83D\uDD0D POSTS SERVICE ENV URL:",e),e){let t=e.includes("/.netlify/functions")?e.replace("/.netlify/functions",""):e;return console.log("\uD83C\uDF10 Posts service using URL:",t),t}let t="https://abstractalgorithms-server.netlify.app";return console.log("⚠️ Posts service using fallback URL:",t),t}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.getServerUrl(),"/.netlify/functions/").concat(e);console.log("\uD83C\uDF10 Making posts request to:",r);let s=await fetch(r,{...t,headers:{"Content-Type":"application/json",...t.headers}});if(!s.ok)throw Error((await s.json().catch(()=>({error:s.statusText}))).error||"Server request failed: ".concat(s.statusText));return s.json()}async getPosts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;try{let r=new URLSearchParams;e.limit&&r.append("limit",e.limit.toString()),e.skip&&r.append("skip",e.skip.toString()),void 0!==e.published&&r.append("published",e.published.toString()),e.sortBy&&r.append("sortBy",e.sortBy),e.sortOrder&&r.append("sortOrder",e.sortOrder),e.tags&&e.tags.length>0&&r.append("tags",e.tags.join(",")),e.author&&r.append("author",e.author),e.search&&r.append("search",e.search);let s={};t&&(s.Authorization="Bearer ".concat(t));let a=await this.makeRequest("posts?".concat(r.toString()),{method:"GET",headers:s});return a.posts&&(a.posts=a.posts.map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}))),a}catch(e){return console.error("Error fetching posts:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getPostById(e,t){try{let r={};t&&(r.Authorization="Bearer ".concat(t));let s=await this.makeRequest("posts?id=".concat(e),{method:"GET",headers:r});return s.post&&(s.post={...s.post,createdAt:new Date(s.post.createdAt),updatedAt:new Date(s.post.updatedAt)}),s}catch(e){return console.error("Error fetching post by ID:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getPostBySlug(e,t){try{let r={};t&&(r.Authorization="Bearer ".concat(t));let s=await this.makeRequest("posts?slug=".concat(e),{method:"GET",headers:r});return s.post&&(s.post={...s.post,createdAt:new Date(s.post.createdAt),updatedAt:new Date(s.post.updatedAt)}),s}catch(e){return console.error("Error fetching post by slug:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async createPost(e,t){try{let r=await this.makeRequest("posts",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});return r.post&&(r.post={...r.post,createdAt:new Date(r.post.createdAt),updatedAt:new Date(r.post.updatedAt)}),r}catch(e){return console.error("Error creating post:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async updatePost(e,t){try{return await this.makeRequest("posts",{method:"PUT",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)})}catch(e){return console.error("Error updating post:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async deletePost(e,t){try{return await this.makeRequest("posts?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})}catch(e){return console.error("Error deleting post:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getMyPosts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return this.getPosts({...e,published:!1},t)}async searchPosts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getPosts({...t,search:e})}}let l=new i,c=(0,r(39763).Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var d=r(94630),u=r(18930),h=r(92369),p=r(31047),m=r(91723),g=r(42208);function x(){let{user:e,userProfile:t}=(0,a.a)(),{posts:r,loading:o,error:i,createPost:x,updatePost:f,deletePost:y,fetchPosts:b}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{autoFetch:t=!0,query:r={}}=e,{user:s}=(0,a.a)(),[o,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),[p,m]=(0,n.useState)(null),[g,x]=(0,n.useState)(r),f=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{d(!0),h(null);let t={...r,...e};x(t);let a=s?await s.getIdToken():void 0,n=await l.getPosts(t,a);n.success&&n.posts?(e.skip&&e.skip>0?i(e=>[...e,...n.posts]):i(n.posts),m(n.pagination||null)):(h(n.error||"Failed to fetch posts"),i([]),m(null))}catch(e){h(e instanceof Error?e.message:"An unexpected error occurred"),i([]),m(null)}finally{d(!1)}},[s,r]),y=(0,n.useCallback)(async e=>{if(!s)return h("Authentication required to create posts"),!1;try{h(null);let t=await s.getIdToken(),r=await l.createPost(e,t);if(r.success)return await f(g),!0;return h(r.error||"Failed to create post"),!1}catch(e){return h(e instanceof Error?e.message:"An unexpected error occurred"),!1}},[s,f,g]),b=(0,n.useCallback)(async e=>{if(!s)return h("Authentication required to update posts"),!1;try{h(null);let t=await s.getIdToken(),r=await l.updatePost(e,t);if(r.success)return i(t=>t.map(t=>t._id===e.id?{...t,...e,updatedAt:new Date}:t)),!0;return h(r.error||"Failed to update post"),!1}catch(e){return h(e instanceof Error?e.message:"An unexpected error occurred"),!1}},[s]),v=(0,n.useCallback)(async e=>{if(!s)return h("Authentication required to delete posts"),!1;try{h(null);let t=await s.getIdToken(),r=await l.deletePost(e,t);if(r.success)return i(t=>t.filter(t=>t._id!==e)),m(e=>e?{...e,total:e.total-1}:null),!0;return h(r.error||"Failed to delete post"),!1}catch(e){return h(e instanceof Error?e.message:"An unexpected error occurred"),!1}},[s]),w=(0,n.useCallback)(async()=>{if(!(null==p?void 0:p.hasMore)||c)return;let e=p.skip+p.limit;await f({...g,skip:e})},[p,c,f,g]),N=(0,n.useCallback)(async()=>{await f({...g,skip:0})},[f,g]);return(0,n.useEffect)(()=>{t&&f(r)},[t]),{posts:o,loading:c,error:u,pagination:p,fetchPosts:f,createPost:y,updatePost:b,deletePost:v,loadMore:w,refresh:N}}({query:{published:!1,limit:10}}),[v,w]=(0,n.useState)(!1),[N,j]=(0,n.useState)(null),[E,k]=(0,n.useState)({title:"",content:"",excerpt:"",tags:"",published:!1}),D=(null==t?void 0:t.role)==="admin"||(null==t?void 0:t.role)==="content-creator",A=async e=>{e.preventDefault();let t={title:E.title,content:E.content,excerpt:E.excerpt||void 0,tags:E.tags.split(",").map(e=>e.trim()).filter(Boolean),published:E.published};(N?await f({...t,id:N}):await x(t))&&(k({title:"",content:"",excerpt:"",tags:"",published:!1}),w(!1),j(null))},P=e=>{k({title:e.title,content:e.content,excerpt:e.excerpt,tags:e.tags.join(", "),published:e.published}),j(e._id),w(!0)},S=async e=>{confirm("Are you sure you want to delete this post?")&&await y(e)};return e?D?(0,s.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Posts Manager"}),!v&&(0,s.jsxs)("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,s.jsx)(c,{className:"w-5 h-5"}),"Create Post"]})]})}),i&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-red-800",children:i})}),v&&(0,s.jsxs)("div",{className:"mb-8 bg-white rounded-lg shadow-md p-6 border",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:N?"Edit Post":"Create New Post"}),(0,s.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,s.jsx)("input",{type:"text",value:E.title,onChange:e=>k(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content *"}),(0,s.jsx)("textarea",{value:E.content,onChange:e=>k(t=>({...t,content:e.target.value})),rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Excerpt"}),(0,s.jsx)("textarea",{value:E.excerpt,onChange:e=>k(t=>({...t,excerpt:e.target.value})),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the post"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags (comma-separated)"}),(0,s.jsx)("input",{type:"text",value:E.tags,onChange:e=>k(t=>({...t,tags:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"javascript, tutorial, web development"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"published",checked:E.published,onChange:e=>k(t=>({...t,published:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"published",className:"ml-2 block text-sm text-gray-900",children:"Publish immediately"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:N?"Update Post":"Create Post"}),(0,s.jsx)("button",{type:"button",onClick:()=>{w(!1),j(null),k({title:"",content:"",excerpt:"",tags:"",published:!1})},className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[o&&(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading posts..."})]}),0===r.length&&!o&&(0,s.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No posts yet"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Create your first post to get started!"})]}),r.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e.title}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>P(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:"Edit post",children:(0,s.jsx)(d.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>S(e._id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete post",children:(0,s.jsx)(u.Z,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:e.excerpt}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.map(e=>(0,s.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},e))}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(h.Z,{className:"w-4 h-4"}),e.authorName]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(p.Z,{className:"w-4 h-4"}),new Date(e.createdAt).toLocaleDateString()]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.Z,{className:"w-4 h-4"}),e.readTime," min read"]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(g.Z,{className:"w-4 h-4"}),e.views," views"]})]}),(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(e.published?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.published?"Published":"Draft"})]})]},e._id))]})]}):(0,s.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-gray-600",children:"You need admin or content-creator permissions to manage posts."})]})}):(0,s.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please sign in to manage posts"}),(0,s.jsx)("p",{className:"text-gray-600",children:"You need to be signed in to view and manage posts."})]})})}var f=r(40257);function y(){let{user:e,userProfile:t,loading:r}=(0,a.a)(),[o,i]=(0,n.useState)("pending"),[l,c]=(0,n.useState)(""),[d,u]=(0,n.useState)("");if((0,n.useEffect)(()=>{let e;let t=f.env.NEXT_PUBLIC_SERVER_URL;u(e=t?t.includes("/.netlify/functions")?t.replace("/.netlify/functions",""):t:"https://abstractalgorithms-server.netlify.app"),(async()=>{try{let r=await fetch("".concat(e,"/.netlify/functions/posts?limit=1"),{method:"GET",headers:{"Content-Type":"application/json"}});if(r.ok){var t;let e=await r.json();i("success"),c("API connection successful. Found ".concat((null===(t=e.posts)||void 0===t?void 0:t.length)||0," posts."))}else throw Error("API returned ".concat(r.status,": ").concat(r.statusText))}catch(e){i("error"),c("API connection failed: ".concat(e.message)),console.error("Posts API test failed:",e)}})()},[]),r)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading authentication..."})]})});let h=(null==t?void 0:t.role)==="admin"||(null==t?void 0:t.role)==="content-creator";return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Posts API Test"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Testing posts functionality and MongoDB integration"})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:["            ",(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"API Connection Test"}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,s.jsx)("strong",{children:"Server URL:"})," ",d||"Loading..."]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:["pending"===o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,s.jsx)("span",{className:"text-gray-600",children:"Testing connection..."})]}),"success"===o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 w-4 bg-green-500 rounded-full"}),(0,s.jsx)("span",{className:"text-green-700",children:l})]}),"error"===o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 w-4 bg-red-500 rounded-full"}),(0,s.jsx)("span",{className:"text-red-700",children:l})]})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Authentication Status"}),e?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Display Name:"})," ",e.displayName||"Not set"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Role:"})," ",(null==t?void 0:t.role)||"No role assigned"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Can Create Posts:"})," ",h?"Yes":"No"]})]}):(0,s.jsx)("p",{className:"text-gray-600",children:"Not authenticated. Please sign in to test posts functionality."})]}),e&&h&&(0,s.jsxs)("div",{className:"bg-white border rounded-lg",children:[(0,s.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Posts Management"})}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(x,{})})]}),e&&!h&&(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Access Restricted"}),(0,s.jsxs)("p",{className:"text-yellow-700",children:["You need admin or content-creator role to access posts functionality. Current role: ",(null==t?void 0:t.role)||"No role assigned"]})]}),!e&&(0,s.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Sign In Required"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Please sign in to test posts functionality. You'll need admin or content-creator role."})]})]})]})})})}},84603:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return d},a:function(){return u}});var s=r(57437),a=r(2265),n=r(43301),o=r(46410),i=r(99764),l=r(40257);let c=(0,a.createContext)(void 0);function d(e){let{children:t}=e,[r,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[p,m]=(0,a.useState)(!0),g=async e=>{try{var t,r;console.log("\uD83D\uDD0D Loading user profile for UID:",e.uid);let s=await e.getIdToken();try{let t=await i.G.getUserProfile(e.uid,s);if(t){console.log("\uD83D\uDCCB Profile data loaded from server:",t),h(t);return}}catch(e){console.warn("⚠️ Server unavailable, using fallback profile:",e)}console.log("\uD83D\uDD04 Creating fallback local profile...");let a=(null===(t=e.email)||void 0===t?void 0:t.includes("admin"))||(null===(r=e.email)||void 0===r?void 0:r.includes("test")),n={uid:e.uid,email:e.email,displayName:e.displayName||e.email.split("@")[0],role:a?"admin":"user",createdAt:new Date,updatedAt:new Date};h(n),console.log("✅ Fallback profile created:",n)}catch(e){console.error("❌ Error loading user profile:",e)}};(0,a.useEffect)(()=>{if(console.log("\uD83D\uDD25 Firebase config:",{configured:o.Wn,apiKey:l.env.NEXT_PUBLIC_FIREBASE_API_KEY?"loaded":"missing",authDomain:l.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN?"loaded":"missing",projectId:l.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID?"loaded":"missing"}),!o.Wn||!o.I8){console.log("⚠️ Firebase not configured, auth will be disabled"),m(!1);return}let e=(0,n.Aj)(o.I8,async e=>{console.log("\uD83D\uDD04 Auth state changed:",e?"User logged in: ".concat(e.email):"User logged out"),d(e),e?(console.log("\uD83D\uDD04 Loading profile for authenticated user..."),await g(e)):(console.log("\uD83D\uDD04 Clearing user profile..."),h(null)),m(!1)});return()=>e()},[]);let x=async(e,t)=>{if(!o.Wn||!o.I8)throw Error("Firebase authentication is not configured");try{console.log("\uD83D\uDD10 useAuth: Starting sign in process for:",e);let r=await (0,n.e5)(o.I8,e,t);console.log("✅ useAuth: Firebase sign in successful:",r.user.uid)}catch(e){throw console.error("❌ useAuth: Sign in failed:",e),Error(e.message)}},f=async(e,t,r)=>{if(!o.Wn||!o.I8)throw Error("Firebase authentication is not configured");try{let{user:s}=await (0,n.Xb)(o.I8,e,t);await (0,n.ck)(s,{displayName:r});let a=await s.getIdToken();await i.G.createUserProfile(s.uid,{email:e,displayName:r,role:"user"},a)}catch(e){throw Error(e.message)}},y=async()=>{if(!o.Wn||!o.I8){console.log("⚠️ Firebase not configured, clearing local state"),d(null),h(null);return}try{await (0,n.w7)(o.I8)}catch(e){throw Error(e.message)}},b=async e=>{if(!o.Wn||!o.I8)throw Error("Firebase authentication is not configured");try{await (0,n.LS)(o.I8,e)}catch(e){throw Error(e.message)}},v=async e=>{if(!r)throw Error("No user authenticated");if(!o.Wn||!o.I8)throw Error("Firebase authentication is not configured");try{let t=await r.getIdToken();if(!await i.G.updateUserProfile(r.uid,e,t))throw Error("Failed to update profile on server");e.displayName&&await (0,n.ck)(r,{displayName:e.displayName}),h(t=>t?{...t,...e,updatedAt:new Date}:null)}catch(e){throw Error(e.message)}};return(0,s.jsx)(c.Provider,{value:{user:r,userProfile:u,loading:p,signIn:x,signUp:f,logout:y,resetPassword:b,updateUserProfile:v,hasPermission:e=>!!u&&(({admin:["create","read","update","delete","manage_users"],editor:["create","read","update"],contributor:["create","read"],reader:["read"]})[u.role]||[]).includes(e)},children:t})}function u(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},46410:function(e,t,r){"use strict";r.d(t,{I8:function(){return d},Wn:function(){return l},db:function(){return u}});var s=r(738),a=r(43301),n=r(5978),o=r(40257);let i={apiKey:o.env.NEXT_PUBLIC_FIREBASE_API_KEY||"dummy-api-key",authDomain:o.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"dummy-project.firebaseapp.com",projectId:o.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"dummy-project"},l=!!(o.env.NEXT_PUBLIC_FIREBASE_API_KEY&&o.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN&&o.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID),c=null,d=null,u=null;try{c=0===(0,s.C6)().length?(0,s.ZF)(i):(0,s.C6)()[0],d=(0,a.v0)(c),u=(0,n.ad)(c),console.log("\uD83D\uDD25 Firebase initialized:",{configured:l,environment:"production"})}catch(e){console.warn("⚠️ Firebase initialization failed:",e),console.log("\uD83D\uDD27 This is normal during build time or when Firebase env vars are missing"),d=null,u=null}},99764:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});var s=r(40257);class a{getServerUrl(){let e=s.env.NEXT_PUBLIC_SERVER_URL;return e?e.includes("/.netlify/functions")?e.replace("/.netlify/functions",""):e:"https://abstractalgorithms-server.netlify.app"}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.getServerUrl(),"/.netlify/functions/").concat(e);console.log("\uD83C\uDF10 Making request to:",r),console.log("\uD83D\uDD27 Environment:","production"),console.log("\uD83D\uDD17 Server URL:",this.getServerUrl());let s=await fetch(r,{...t,headers:{"Content-Type":"application/json",...t.headers}});if(!s.ok)throw console.error("❌ Server request failed:",s.status,s.statusText),Error("Server request failed: ".concat(s.statusText));return s.json()}async getUserProfile(e,t){try{let r={};t&&(r.Authorization="Bearer ".concat(t));let s=await this.makeRequest("firebase-auth?uid=".concat(e),{method:"GET",headers:r});if(s.success&&s.user)return{...s.user,createdAt:new Date(s.user.createdAt),updatedAt:new Date(s.user.updatedAt)};return null}catch(e){return console.error("Error fetching user profile:",e),null}}async updateUserProfile(e,t,r){try{return(await this.makeRequest("firebase-auth",{method:"PUT",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({uid:e,updateData:{...t,updatedAt:new Date().toISOString()}})})).success}catch(e){return console.error("Error updating user profile:",e),!1}}async listUsers(e){try{let t=await this.makeRequest("firebase-auth?action=list_users",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(t.success&&t.users)return t.users.map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));return[]}catch(e){return console.error("Error listing users:",e),[]}}async updateUserRole(e,t,r){try{return(await this.makeRequest("firebase-auth",{method:"PUT",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({uid:e,role:t,updateData:{role:t,updatedAt:new Date().toISOString()}})})).success}catch(e){return console.error("Error updating user role:",e),!1}}async createUserProfile(e,t,r){try{return(await this.makeRequest("firebase-auth",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({uid:e,...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})})).success}catch(e){return console.error("Error creating user profile:",e),!1}}async deleteUser(e,t){try{return(await this.makeRequest("firebase-auth?uid=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).success}catch(e){return console.error("Error deleting user:",e),!1}}}let n=new a}},function(e){e.O(0,[4358,139,244,5973,5605,2971,2117,1744],function(){return e(e.s=66165)}),_N_E=e.O()}]);