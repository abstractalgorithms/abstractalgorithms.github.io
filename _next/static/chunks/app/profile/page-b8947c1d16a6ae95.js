(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4178],{44986:function(e,t,r){Promise.resolve().then(r.bind(r,1380))},39763:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{color:o="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:h,...m}=r;return(0,a.createElement)("svg",{ref:i,...s,width:l,height:l,stroke:o,strokeWidth:u?24*Number(c)/Number(l):c,className:["lucide","lucide-".concat(n(e)),d].join(" "),...m},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(h)?h:[h]])});return r.displayName="".concat(e),r}},32660:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},31047:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},29202:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},89345:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},83774:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2207:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]])},83229:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},88906:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},92369:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},32489:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},27648:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(72972),s=r.n(a)},99376:function(e,t,r){"use strict";var a=r(35475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},1380:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var a=r(57437),s=r(2265),n=r(84603),i=r(99376),o=r(88906),l=r(2207),c=r(92369),u=r(32660),d=r(83229),h=r(32489),m=r(89345),f=r(29202),g=r(83774),x=r(31047),p=r(27648);function y(){let{user:e,userProfile:t,loading:r,updateUserProfile:y}=(0,n.a)(),b=(0,i.useRouter)(),[w,N]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[D,E]=(0,s.useState)({displayName:"",bio:"",website:"",location:""});(0,s.useEffect)(()=>{r||e||b.push("/")},[e,r,b]),(0,s.useEffect)(()=>{t&&E({displayName:t.displayName||"",bio:t.bio||"",website:t.website||"",location:t.location||""})},[t]);let k=async()=>{try{j(!0),await y(D),N(!1)}catch(e){console.error("Error updating profile:",e),alert("Failed to update profile. Please try again.")}finally{j(!1)}};if(r)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-gray-900"})});if(!e||!t)return null;let A=e=>{switch(e){case"admin":return(0,a.jsx)(o.Z,{className:"w-4 h-4"});case"content-creator":return(0,a.jsx)(l.Z,{className:"w-4 h-4"});default:return(0,a.jsx)(c.Z,{className:"w-4 h-4"})}};return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(p.default,{href:"/",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Back to Home"})]}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"My Profile"})]})})}),(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-12",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 h-32 relative",children:[(0,a.jsx)("div",{className:"absolute -bottom-16 left-8",children:(0,a.jsx)("div",{className:"w-32 h-32 bg-white rounded-full border-4 border-white shadow-lg flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-28 h-28 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-full flex items-center justify-center text-white text-3xl font-bold",children:(t.displayName||t.email).charAt(0).toUpperCase()})})}),(0,a.jsx)("div",{className:"absolute top-4 right-4",children:w?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:k,disabled:v,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors disabled:opacity-50",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),v?"Saving...":"Save"]}),(0,a.jsxs)("button",{onClick:()=>{t&&E({displayName:t.displayName||"",bio:t.bio||"",website:t.website||"",location:t.location||""}),N(!1)},className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors backdrop-blur-sm",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),"Cancel"]})]}):(0,a.jsxs)("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors backdrop-blur-sm",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4"}),"Edit Profile"]})})]}),(0,a.jsxs)("div",{className:"pt-20 pb-8 px-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[w?(0,a.jsx)("input",{type:"text",value:D.displayName,onChange:e=>E({...D,displayName:e.target.value}),placeholder:"Your display name",className:"text-2xl font-bold text-gray-900 bg-transparent border-b-2 border-blue-500 focus:outline-none focus:border-blue-600 w-full max-w-md"}):(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:t.displayName||"No Display Name"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-gray-600",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:t.email})]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium border ".concat((e=>{switch(e){case"admin":return"bg-red-100 text-red-800 border-red-200";case"content-creator":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(t.role)),children:[A(t.role),"content-creator"===t.role?"Content Creator":t.role.charAt(0).toUpperCase()+t.role.slice(1)]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),w?(0,a.jsx)("textarea",{value:D.bio,onChange:e=>E({...D,bio:e.target.value}),placeholder:"Tell us about yourself...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"}):(0,a.jsx)("p",{className:"text-gray-600 whitespace-pre-wrap",children:t.bio||"No bio added yet."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),w?(0,a.jsx)("input",{type:"url",value:D.website,onChange:e=>E({...D,website:e.target.value}),placeholder:"https://your-website.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4"}),t.website?(0,a.jsx)("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 hover:underline",children:t.website}):(0,a.jsx)("span",{children:"No website added"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),w?(0,a.jsx)("input",{type:"text",value:D.location,onChange:e=>E({...D,location:e.target.value}),placeholder:"Your location",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}):(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:t.location||"No location added"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Information"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"User ID"}),(0,a.jsxs)("code",{className:"text-xs bg-white px-2 py-1 rounded border font-mono",children:[t.uid.substring(0,12),"..."]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Member since"}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-900",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3"}),t.createdAt.toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Last updated"}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-900",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3"}),t.updatedAt.toLocaleDateString()]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role & Permissions"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[A(t.role),(0,a.jsx)("span",{className:"font-medium",children:"content-creator"===t.role?"Content Creator":t.role.charAt(0).toUpperCase()+t.role.slice(1)})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["admin"===t.role&&"Full access to all features and user management","content-creator"===t.role&&"Can create and manage content","user"===t.role&&"Basic user access to read content"]})]})]})]})]})]})]})})]})}},84603:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return u},a:function(){return d}});var a=r(57437),s=r(2265),n=r(43301),i=r(46410),o=r(99764),l=r(40257);let c=(0,s.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,s.useState)(null),[d,h]=(0,s.useState)(null),[m,f]=(0,s.useState)(!0),g=async e=>{try{var t,r;console.log("\uD83D\uDD0D Loading user profile for UID:",e.uid);let a=await e.getIdToken();try{let t=await o.G.getUserProfile(e.uid,a);if(t){console.log("\uD83D\uDCCB Profile data loaded from server:",t),h(t);return}}catch(e){console.warn("⚠️ Server unavailable, using fallback profile:",e)}console.log("\uD83D\uDD04 Creating fallback local profile...");let s=(null===(t=e.email)||void 0===t?void 0:t.includes("admin"))||(null===(r=e.email)||void 0===r?void 0:r.includes("test")),n={uid:e.uid,email:e.email,displayName:e.displayName||e.email.split("@")[0],role:s?"admin":"user",createdAt:new Date,updatedAt:new Date};h(n),console.log("✅ Fallback profile created:",n)}catch(e){console.error("❌ Error loading user profile:",e)}};(0,s.useEffect)(()=>{if(console.log("\uD83D\uDD25 Firebase config:",{configured:i.Wn,apiKey:l.env.NEXT_PUBLIC_FIREBASE_API_KEY?"loaded":"missing",authDomain:l.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN?"loaded":"missing",projectId:l.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID?"loaded":"missing"}),!i.Wn||!i.I8){console.log("⚠️ Firebase not configured, auth will be disabled"),f(!1);return}let e=(0,n.Aj)(i.I8,async e=>{console.log("\uD83D\uDD04 Auth state changed:",e?"User logged in: ".concat(e.email):"User logged out"),u(e),e?(console.log("\uD83D\uDD04 Loading profile for authenticated user..."),await g(e)):(console.log("\uD83D\uDD04 Clearing user profile..."),h(null)),f(!1)});return()=>e()},[]);let x=async(e,t)=>{if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{console.log("\uD83D\uDD10 useAuth: Starting sign in process for:",e);let r=await (0,n.e5)(i.I8,e,t);console.log("✅ useAuth: Firebase sign in successful:",r.user.uid)}catch(e){throw console.error("❌ useAuth: Sign in failed:",e),Error(e.message)}},p=async(e,t,r)=>{if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{let{user:a}=await (0,n.Xb)(i.I8,e,t);await (0,n.ck)(a,{displayName:r});let s=await a.getIdToken();await o.G.createUserProfile(a.uid,{email:e,displayName:r,role:"user"},s)}catch(e){throw Error(e.message)}},y=async()=>{if(!i.Wn||!i.I8){console.log("⚠️ Firebase not configured, clearing local state"),u(null),h(null);return}try{await (0,n.w7)(i.I8)}catch(e){throw Error(e.message)}},b=async e=>{if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{await (0,n.LS)(i.I8,e)}catch(e){throw Error(e.message)}},w=async e=>{if(!r)throw Error("No user authenticated");if(!i.Wn||!i.I8)throw Error("Firebase authentication is not configured");try{let t=await r.getIdToken();if(!await o.G.updateUserProfile(r.uid,e,t))throw Error("Failed to update profile on server");e.displayName&&await (0,n.ck)(r,{displayName:e.displayName}),h(t=>t?{...t,...e,updatedAt:new Date}:null)}catch(e){throw Error(e.message)}};return(0,a.jsx)(c.Provider,{value:{user:r,userProfile:d,loading:m,signIn:x,signUp:p,logout:y,resetPassword:b,updateUserProfile:w,hasPermission:e=>!!d&&(({admin:["create","read","update","delete","manage_users"],editor:["create","read","update"],contributor:["create","read"],reader:["read"]})[d.role]||[]).includes(e)},children:t})}function d(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},46410:function(e,t,r){"use strict";r.d(t,{I8:function(){return u},Wn:function(){return l},db:function(){return d}});var a=r(738),s=r(43301),n=r(5978),i=r(40257);let o={apiKey:i.env.NEXT_PUBLIC_FIREBASE_API_KEY||"dummy-api-key",authDomain:i.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"dummy-project.firebaseapp.com",projectId:i.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"dummy-project"},l=!!(i.env.NEXT_PUBLIC_FIREBASE_API_KEY&&i.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN&&i.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID),c=null,u=null,d=null;try{c=0===(0,a.C6)().length?(0,a.ZF)(o):(0,a.C6)()[0],u=(0,s.v0)(c),d=(0,n.ad)(c),console.log("\uD83D\uDD25 Firebase initialized:",{configured:l,environment:"production"})}catch(e){console.warn("⚠️ Firebase initialization failed:",e),console.log("\uD83D\uDD27 This is normal during build time or when Firebase env vars are missing"),u=null,d=null}},99764:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});var a=r(40257);class s{getServerUrl(){let e=a.env.NEXT_PUBLIC_SERVER_URL;return e?e.includes("/.netlify/functions")?e.replace("/.netlify/functions",""):e:"https://abstractalgorithms-server.netlify.app"}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.getServerUrl(),"/.netlify/functions/").concat(e);console.log("\uD83C\uDF10 Making request to:",r),console.log("\uD83D\uDD27 Environment:","production"),console.log("\uD83D\uDD17 Server URL:",this.getServerUrl());let a=await fetch(r,{...t,headers:{"Content-Type":"application/json",...t.headers}});if(!a.ok)throw console.error("❌ Server request failed:",a.status,a.statusText),Error("Server request failed: ".concat(a.statusText));return a.json()}async getUserProfile(e,t){try{let r={};t&&(r.Authorization="Bearer ".concat(t));let a=await this.makeRequest("firebase-auth?uid=".concat(e),{method:"GET",headers:r});if(a.success&&a.user)return{...a.user,createdAt:new Date(a.user.createdAt),updatedAt:new Date(a.user.updatedAt)};return null}catch(e){return console.error("Error fetching user profile:",e),null}}async updateUserProfile(e,t,r){try{return(await this.makeRequest("firebase-auth",{method:"PUT",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({uid:e,updateData:{...t,updatedAt:new Date().toISOString()}})})).success}catch(e){return console.error("Error updating user profile:",e),!1}}async listUsers(e){try{let t=await this.makeRequest("firebase-auth?action=list_users",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(t.success&&t.users)return t.users.map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));return[]}catch(e){return console.error("Error listing users:",e),[]}}async updateUserRole(e,t,r){try{return(await this.makeRequest("firebase-auth",{method:"PUT",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({uid:e,role:t,updateData:{role:t,updatedAt:new Date().toISOString()}})})).success}catch(e){return console.error("Error updating user role:",e),!1}}async createUserProfile(e,t,r){try{return(await this.makeRequest("firebase-auth",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({uid:e,...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})})).success}catch(e){return console.error("Error creating user profile:",e),!1}}async deleteUser(e,t){try{return(await this.makeRequest("firebase-auth?uid=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).success}catch(e){return console.error("Error deleting user:",e),!1}}}let n=new s}},function(e){e.O(0,[4358,139,2972,244,5973,5605,2971,2117,1744],function(){return e(e.s=44986)}),_N_E=e.O()}]);