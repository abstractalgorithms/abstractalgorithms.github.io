(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{14620:function(e,s,t){Promise.resolve().then(t.bind(t,98426))},65302:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},98617:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]])},42208:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},48736:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},90740:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},73247:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},45131:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},98426:function(e,s,t){"use strict";let a;t.r(s),t.d(s,{default:function(){return Z}});var l=t(57437),r=t(2265),n=t(84603),i=t(20438),c=t(99764),d=t(98646),o=t(27648),m=t(98617),x=t(2207);let u=(0,t(39763).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var h=t(45131),p=t(95805),g=t(48736),f=t(42208),j=t(98728),N=t(73247),b=t(90740),y=t(31047),v=t(65302),w=t(738),k=t(92529),A=t(40257);let E={apiKey:A.env.NEXT_PUBLIC_FIREBASE_API_KEY||"dummy-api-key",authDomain:A.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"dummy-project.firebaseapp.com",projectId:A.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"dummy-project",databaseURL:A.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL||"https://dummy-project-default-rtdb.firebaseio.com/"},C=!!(A.env.NEXT_PUBLIC_FIREBASE_API_KEY&&A.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN&&A.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID&&A.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL);try{a=(0,w.C6)().length?(0,w.C6)()[0]:(0,w.ZF)(E)}catch(e){console.warn("⚠️ Firebase initialization failed in getViewerCount:",e),a=null}async function D(){if(!C||!a)return console.log("⚠️ Firebase not configured or running in build time, returning mock viewer count"),0;try{let e=(0,k.N8)(a),s=(0,k.iH)(e,"stats/viewerCount"),t=await (0,k.U2)(s);if(t.exists())return t.val();return 0}catch(e){return console.error("Error fetching viewer count:",e),0}}function Z(){var e,s;let{user:t,userProfile:a,loading:w}=(0,n.a)(),[k,A]=(0,r.useState)([]),[E,C]=(0,r.useState)([]),[Z,_]=(0,r.useState)(!0),[U,S]=(0,r.useState)(""),[I,L]=(0,r.useState)("all"),[R,T]=(0,r.useState)(null),[B,F]=(0,r.useState)(!1),[P,z]=(0,r.useState)(!1),[M,X]=(0,r.useState)(null),[O,q]=(0,r.useState)(0),[H,V]=(0,r.useState)(0);(0,r.useEffect)(()=>{console.log("\uD83D\uDD0D Admin page useEffect triggered:",{userProfile:null==a?void 0:a.email,user:null==t?void 0:t.email,loading:w,hasUser:!!t,hasUserProfile:!!a}),w||K()},[w]),(0,r.useEffect)(()=>{let e=k;U&&(e=e.filter(e=>e.email.toLowerCase().includes(U.toLowerCase())||e.displayName&&e.displayName.toLowerCase().includes(U.toLowerCase()))),"all"!==I&&(e=e.filter(e=>e.role===I)),C(e)},[k,U,I]),(0,r.useEffect)(()=>{q(Object.keys(d.R0).length),D().then(V)},[w,t]);let K=async()=>{try{if(_(!0),X(null),console.log("\uD83D\uDD04 Loading users from server..."),t)try{let e=await t.getIdToken(),s=await c.G.listUsers(e);console.log("✅ Loaded users from server:",s),A(s);return}catch(e){console.warn("⚠️ Server unavailable, using mock data for testing:",e)}console.log("\uD83D\uDD04 Creating fallback mock users...");let e=(null==t?void 0:t.email)||"admin@test.com",s=e.includes("admin")||e.includes("test"),a=[{uid:(null==t?void 0:t.uid)||"mock-admin-1",email:e,displayName:(null==t?void 0:t.displayName)||"Admin User",role:s?"admin":"user",createdAt:new Date,updatedAt:new Date},{uid:"mock-user-1",email:"user1@example.com",displayName:"Test User 1",role:"user",createdAt:new Date,updatedAt:new Date},{uid:"mock-user-2",email:"editor@example.com",displayName:"Test Editor",role:"content-creator",createdAt:new Date,updatedAt:new Date},{uid:"mock-user-3",email:"admin2@example.com",displayName:"Test Admin 2",role:"admin",createdAt:new Date,updatedAt:new Date}];A(a)}catch(e){console.error("❌ Error loading users:",e),X(e instanceof Error?e.message:"Failed to load users")}finally{_(!1)}},Y=async(e,s)=>{try{if(z(!0),console.log("\uD83D\uDD04 Updating user role:",{uid:e,newRole:s}),!t)throw Error("Not authenticated");let a=await t.getIdToken();await c.G.updateUserRole(a,e,s),console.log("✅ User role updated successfully"),A(t=>t.map(t=>t.uid===e?{...t,role:s,updatedAt:new Date}:t)),F(!1),T(null)}catch(t){console.error("❌ Error updating user role:",t),t instanceof Error&&t.message.includes("Failed to fetch")?(console.log("⚠️ Server unavailable, updating role locally for testing"),A(t=>t.map(t=>t.uid===e?{...t,role:s,updatedAt:new Date}:t)),F(!1),T(null)):X(t instanceof Error?t.message:"Failed to update user role")}finally{z(!1)}},G=e=>{switch(e){case"admin":return(0,l.jsx)(m.Z,{className:"w-5 h-5 text-purple-600"});case"content-creator":return(0,l.jsx)(x.Z,{className:"w-5 h-5 text-blue-600"});default:return(0,l.jsx)(u,{className:"w-5 h-5 text-gray-600"})}},J=e=>{switch(e){case"admin":return"bg-purple-100 text-purple-800 border-purple-200";case"content-creator":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return w||Z?(console.log("⏳ Admin page in loading state:",{loading:w,loadingUsers:Z}),w&&!Z)?(0,l.jsx)(i.Z,{title:"Authenticating",description:"Please wait...",children:(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Authenticating..."})]})})}):(0,l.jsx)(i.Z,{title:"Loading Users",description:"Fetching user data...",children:(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading users..."})]})})}):(null==a?void 0:a.role)==="admin"||(null==t?void 0:null===(e=t.email)||void 0===e?void 0:e.includes("admin"))||(null==t?void 0:null===(s=t.email)||void 0===s?void 0:s.includes("test"))?(0,l.jsx)(i.Z,{title:"Admin Dashboard",description:"Manage users, content, and platform settings",children:(0,l.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage users, content, and platform settings"})]}),M&&(0,l.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(h.Z,{className:"w-5 h-5 text-red-600"}),(0,l.jsx)("p",{className:"text-red-800",children:M})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-6 mb-8",children:[(0,l.jsx)(o.default,{href:"/admin/users",className:"block",children:(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(p.Z,{className:"w-8 h-8 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:k.length}),(0,l.jsx)("p",{className:"text-gray-600",children:"Total Users"})]})]})})}),(0,l.jsx)(o.default,{href:"/discover",className:"block",children:(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(g.Z,{className:"w-8 h-8 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:O}),(0,l.jsx)("p",{className:"text-gray-600",children:"Series"})]})]})})}),(0,l.jsx)(o.default,{href:"/posts",className:"block",children:(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(x.Z,{className:"w-8 h-8 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:k.filter(e=>"content-creator"===e.role).length}),(0,l.jsx)("p",{className:"text-gray-600",children:"Content Creators"})]})]})})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(m.Z,{className:"w-8 h-8 text-purple-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:k.filter(e=>"admin"===e.role).length}),(0,l.jsx)("p",{className:"text-gray-600",children:"Admins"})]})]})}),(0,l.jsx)(o.default,{href:"/admin/analytics",className:"block",children:(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(f.Z,{className:"w-8 h-8 text-purple-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:H}),(0,l.jsx)("p",{className:"text-gray-600",children:"Viewers"})]})]})})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,l.jsx)(o.default,{href:"/admin/deployment",className:"block",children:(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)(j.Z,{className:"w-6 h-6 text-blue-600"}),(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Deployment Settings"})]}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage deployment banners and announcements"})]})}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)(g.Z,{className:"w-6 h-6 text-green-600"}),(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Content Management"})]}),(0,l.jsx)("p",{className:"text-gray-600",children:"Review and moderate user-generated content"})]}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)(f.Z,{className:"w-6 h-6 text-purple-600"}),(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Analytics"})]}),(0,l.jsx)("p",{className:"text-gray-600",children:"View platform usage and engagement metrics"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,l.jsxs)("div",{className:"p-6 border-b",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"User Management"}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"relative flex-1",children:[(0,l.jsx)(N.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Search users by email or name...",value:U,onChange:e=>S(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(b.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,l.jsxs)("select",{value:I,onChange:e=>L(e.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"all",children:"All Roles"}),(0,l.jsx)("option",{value:"admin",children:"Admin"}),(0,l.jsx)("option",{value:"content-creator",children:"Content Creator"}),(0,l.jsx)("option",{value:"user",children:"User"})]})]})]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-200",children:E.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-medium",children:(e.displayName||e.email).charAt(0).toUpperCase()})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.displayName||"No name"}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[G(e.role),(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ".concat(J(e.role)),children:e.role.replace("-"," ")})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(y.Z,{className:"w-4 h-4"}),e.createdAt.toLocaleDateString()]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(o.default,{href:"/admin/users/".concat(e.uid),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[(0,l.jsx)(f.Z,{className:"w-4 h-4"}),"View"]}),(0,l.jsxs)("button",{onClick:()=>{T(e),F(!0)},className:"text-purple-600 hover:text-purple-700 flex items-center gap-1",children:[(0,l.jsx)(j.Z,{className:"w-4 h-4"}),"Role"]})]})})]},e.uid))})]})}),0===E.length&&(0,l.jsxs)("div",{className:"p-8 text-center",children:[(0,l.jsx)(p.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-500",children:"No users found matching your criteria."})]})]}),B&&R&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-medium",children:(R.displayName||R.email).charAt(0).toUpperCase()})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold",children:["Change Role for ",R.displayName||R.email]}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:R.email})]})]}),(0,l.jsx)("div",{className:"space-y-3 mb-6",children:["admin","content-creator","user"].map(e=>(0,l.jsxs)("button",{onClick:()=>Y(R.uid,e),disabled:P||R.role===e,className:"w-full flex items-center gap-3 p-3 rounded-lg border transition-colors ".concat(R.role===e?"bg-blue-50 border-blue-200 cursor-not-allowed":"hover:bg-gray-50 border-gray-200"),children:[G(e),(0,l.jsxs)("div",{className:"text-left",children:[(0,l.jsx)("div",{className:"font-medium capitalize",children:e.replace("-"," ")}),(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["admin"===e&&"Full access to all features and user management","content-creator"===e&&"Can create and manage content","user"===e&&"Basic user access"]})]}),R.role===e&&(0,l.jsx)(v.Z,{className:"w-5 h-5 text-blue-600 ml-auto"})]},e))}),(0,l.jsx)("div",{className:"flex gap-3",children:(0,l.jsx)("button",{onClick:()=>{F(!1),T(null)},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",disabled:P,children:"Cancel"})}),P&&(0,l.jsxs)("div",{className:"mt-4 text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Updating role..."})]})]})})]})}):(0,l.jsx)(i.Z,{title:"Access Denied",description:"Admin access required",children:(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(h.Z,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access the admin dashboard."}),(0,l.jsx)(o.default,{href:"/",className:"text-blue-600 hover:text-blue-700",children:"Return to Home"})]})})})}},98646:function(e,s,t){"use strict";t.d(s,{R0:function(){return a}});let a={}}},function(e){e.O(0,[4358,139,7481,2972,244,5973,5605,6299,2971,2117,1744],function(){return e(e.s=14620)}),_N_E=e.O()}]);